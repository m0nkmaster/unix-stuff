#!/bin/bash 
#
# Reithproxies script = sets up my mac for working on or off Reith

if [ "x$1" != "xon" ] && [ "x$1" != "xoff" ]; then 
    echo "Usage: $0 <on/off>"
    exit 1
fi

# Always use my .bashrc 
. ~/.bashrc

# Stop stunnel
killall stunnel

localeName=work
networkLocation=On

if [ "${1}"  == "off" ]; then
    localeName=home
    networkLocation=Off

    echo "Removing Reith proxy env variables"
    . ~/.removeproxies
else 
    echo "Adding Reith proxy env variables"
    . ~/.reithproxies
fi

echo "Changing SVN settings"
ln -sf /Volumes/SecureDrive/subversion/servers.$localeName /Volumes/SecureDrive/subversion/servers

echo "Changing Stunnel settings"
ln -sf /Volumes/SecureDrive/stunnel/stunnel-$localeName.conf /Volumes/SecureDrive/stunnel/stunnel.conf
stunnel

echo "Switching Network Location"
sudo networksetup -switchtolocation "BBC $networkLocation Network"